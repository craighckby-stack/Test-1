{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://gax.agi/schema/ConstraintResolutionEngineDefinition.schema.json",
  "title": "GAX Constraint Resolution Engine Definition",
  "description": "Defines the structured configuration for the GAX Constraint Resolution Engine, emphasizing performant lookup and phase ordering.",
  "type": "object",
  "required": ["engineId", "resolutionPhases", "strategyMap"],
  "properties": {
    "engineId": { "type": "string", "description": "Unique identifier for this engine configuration." },
    "version": { "type": "string", "description": "Schema version tracking." },
    "globalConfig": {
      "type": "object",
      "properties": {
        "maxRetries": { "type": "integer", "minimum": 0, "default": 3 },
        "conflictResolutionMode": { "type": "string", "enum": ["fail_hard", "partial_satisfaction", "dynamic_reversion"], "default": "dynamic_reversion" }
      },
      "additionalProperties": false
    },
    "resolutionPhases": {
      "type": "array",
      "description": "Ordered list of resolution phases. Dependencies must be defined relative to this list.",
      "items": { "$ref": "#/$defs/ResolutionPhase" }
    },
    "strategyMap": {
      "type": "object",
      "description": "A mapping of constraint categories (keys) to specific resolution strategies (values) for O(1) lookup.",
      "patternProperties": {
        "^[A-Z][A-Z0-9_]+$": { "$ref": "#/$defs/StrategyDefinition" }
      },
      "additionalProperties": false
    }
  },
  "$defs": {
    "ResolutionPhase": {
      "type": "object",
      "required": ["phaseId", "dependencies", "concurrentExecution"],
      "properties": {
        "phaseId": { "type": "string", "description": "Unique ID for the phase (used in dependency tracking)." },
        "dependencies": {
          "type": "array",
          "description": "IDs of phases that must complete before this phase starts (empty array implies starting phase).",
          "items": { "type": "string" }
        },
        "concurrentExecution": { "type": "boolean", "description": "If true, constraints within this phase can be resolved in parallel." }
      },
      "additionalProperties": false
    },
    "StrategyDefinition": {
      "type": "object",
      "required": ["solverType", "handlerModule"],
      "properties": {
        "solverType": { "type": "string", "enum": ["Backtracking", "Genetic", "SAT", "Heuristic"], "description": "Classification of the resolution algorithm used." },
        "handlerModule": { "type": "string", "description": "Path or reference to the actual implementation module." },
        "configuration": { "type": "object", "description": "Solver-specific initialization parameters." }
      },
      "additionalProperties": false
    }
  }
}