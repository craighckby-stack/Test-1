{
  "metadata": {
    "configId": "SE_PCF_v3",
    "description": "Sovereign Engine Policy Compliance Filter - Operational and Security Constraints (Refactored)",
    "version": "3.0.0",
    "schemaVersion": "1.1",
    "enabled": true
  },
  "filter_groups": {
    "OperationalSafeguards": {
      "executionMode": "CRITICAL_PATH",
      "priority": 900,
      "enabled": true,
      "targetType": "INPUT_CONTEXT",
      "rules": [
        {
          "ruleId": "SM_001",
          "name": "CoreConstraintModification",
          "targetScope": "CORE_STATE_MUTATION",
          "action": "BLOCK_HARD",
          "regex": "^(REWRITE_MISSION|MODIFY_CORE_CONSTRAINTS|ALTER_VERSION_SPEC)$",
          "description": "Prevents instructions targeting immutable core state attributes."
        },
        {
          "ruleId": "CI_002",
          "name": "UntrustedCodeInclusion",
          "targetScope": "EXECUTION_ENVIRONMENT_INPUT",
          "action": "DENY",
          "regex": "(import\\s+.*\\s+from|require\\s*\\()|eval\\(",
          "description": "Filters module loading, file system calls, or dynamic execution attempts."
        }
      ]
    },
    "DataSanitization": {
      "executionMode": "BUFFER_PROCESSING",
      "priority": 100,
      "enabled": true,
      "targetType": "LOG_DATA",
      "rules": [
        {
          "ruleId": "PIS_003",
          "name": "EmailPIIMasking",
          "targetScope": "LOG_BUFFER_WRITE",
          "action": "MASK_TRANSFORM",
          "regex": "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}",
          "description": "Masks detected email patterns prior to permanent logging."
        }
      ]
    }
  }
}