{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://agi.sovereign/schemas/acvd_v1.0.json",
  "title": "Autonomous Code Versioning and Deployment (ACVD) Proposal Schema",
  "description": "Defines the required structure for any autonomous code evolution proposal generated by the AGI, ensuring traceability, governance, and risk mitigation.",
  "type": "object",
  "properties": {
    "proposalId": {
      "type": "string",
      "format": "uuid",
      "description": "A unique UUID identifier for this specific proposal."
    },
    "schemaVersion": {
      "type": "string",
      "const": "1.0",
      "description": "Version of the ACVD schema being used."
    },
    "sourceModule": {
      "type": "string",
      "description": "The specific internal component or agent that generated the proposal (e.g., 'RefactorEngine', 'GoalDecompositionUnit')."
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "UTC timestamp of proposal creation."
    },
    "evolutionaryLogic": {
      "type": "object",
      "properties": {
        "objectiveId": {
          "type": "string",
          "description": "ID corresponding to the higher-level mission objective this change addresses."
        },
        "refactoringRationale": {
          "type": "string",
          "minLength": 50,
          "description": "Detailed explanation of why this change improves efficiency, intelligence, or addresses a flaw."
        },
        "impactScope": {
          "type": "string",
          "enum": ["CORE", "FEATURE", "GOVERNANCE", "UTILITY", "CONFIG"],
          "description": "The area of the system primarily impacted."
        }
      },
      "required": [
        "objectiveId",
        "refactoringRationale",
        "impactScope"
      ]
    },
    "changeSet": {
      "type": "array",
      "description": "List of files to be modified, created, or deleted.",
      "items": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "Relative path to the file."
          },
          "operation": {
            "type": "string",
            "enum": [
              "CREATE",
              "UPDATE",
              "DELETE"
            ]
          },
          "diffSummary": {
            "type": "string",
            "description": "High-level view of changes (e.g., '+20 lines, -5 lines, Function `X` refactored')."
          }
        },
        "required": [
          "path",
          "operation"
        ]
      },
      "minItems": 1
    },
    "riskAssessment": {
      "type": "object",
      "properties": {
        "severity": {
          "type": "number",
          "minimum": 1,
          "maximum": 5,
          "description": "Estimated risk of failure or critical degradation (1=Low, 5=Catastrophic)."
        },
        "requiredTestType": {
          "type": "string",
          "enum": ["UNIT", "INTEGRATION", "END_TO_END", "NONE"],
          "description": "Minimum validation step required before merging."
        },
        "rollbackPlan": {
          "type": "string",
          "description": "Brief description of the automated plan to revert this change if failure occurs."
        }
      },
      "required": [
        "severity",
        "requiredTestType",
        "rollbackPlan"
      ]
    }
  },
  "required": [
    "proposalId",
    "schemaVersion",
    "sourceModule",
    "timestamp",
    "evolutionaryLogic",
    "changeSet",
    "riskAssessment"
  ],
  "additionalProperties": false
}