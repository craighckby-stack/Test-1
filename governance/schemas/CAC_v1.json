{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://sovereign.agi/schemas/CAC_v1.json",
  "title": "Certified Access Credential (CAC) Schema v1",
  "description": "Defines the canonical structure for cryptographically verifiable access credentials used within the Sovereign AGI governance layer.",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "asset_version": {
      "type": "string",
      "description": "The specific semantic version identifier for this credential structure (vX.Y).",
      "pattern": "^v(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\z"
    },
    "signing_key_id": {
      "type": "string",
      "description": "UUID reference identifying the public key used for signing the external wrapper or validating the internal payload.",
      "format": "uuid"
    },
    "checksum_sha512": {
      "type": "string",
      "description": "Cryptographic SHA-512 hash (128 hex characters) of the complete canonicalized asset contents, excluding external signatures.",
      "pattern": "^[a-fA-F0-9]{128}$"
    },
    "credential_payload": {
      "type": "object",
      "description": "Encrypted or protected core credential data, expected to conform to the CAC_Payload schema upon decryption/parsing.",
      "minProperties": 1
    }
  },
  "required": [
    "asset_version",
    "signing_key_id",
    "checksum_sha512",
    "credential_payload"
  ]
}