{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "$id": "https://governance.agi.v94/gsim_enforcement_schema.json",
  "title": "GSIM Enforcement Rule Configuration",
  "description": "Defines the structured rules and policies for enforcing Governance System Integrity Model (GSIM) constraints within the AGI architecture.",
  "type": "object",
  "properties": {
    "schemaVersion": {
      "type": "string",
      "enum": ["v1.0.0"],
      "description": "Version of the enforcement schema definition."
    },
    "defaultSeverity": {
      "type": "string",
      "enum": ["WARN", "ERROR", "CRITICAL"],
      "default": "ERROR"
    },
    "rules": {
      "type": "array",
      "description": "A list of individual enforcement rules.",
      "items": {
        "type": "object",
        "required": ["ruleId", "targetScope", "constraintType", "definition"],
        "properties": {
          "ruleId": {
            "type": "string",
            "pattern": "^GSIM-[A-Z0-9]{4,6}$",
            "description": "Unique identifier for the GSIM rule (e.g., GSIM-SINT-01)."
          },
          "targetScope": {
            "type": "string",
            "enum": ["SYSTEM_WIDE", "DOMAIN_SPECIFIC", "COMPONENT_LOCAL"],
            "description": "The scope to which this rule applies."
          },
          "constraintType": {
            "type": "string",
            "enum": ["STRUCTURAL_INTEGRITY", "BEHAVIORAL_COMPLIANCE", "RESOURCE_LIMIT"],
            "description": "Categorization of the check."
          },
          "description": {
            "type": "string"
          },
          "active": {
            "type": "boolean",
            "default": true
          },
          "severity": {
            "type": "string",
            "enum": ["INFO", "WARN", "ERROR", "CRITICAL"],
            "default": "ERROR"
          },
          "definition": {
            "type": "object",
            "description": "The actual logic for enforcement.",
            "oneOf": [
              {"$ref": "#/definitions/structuralRule"},
              {"$ref": "#/definitions/behavioralRule"},
              {"$ref": "#/definitions/resourceRule"}
            ]
          }
        }
      }
    }
  },
  "definitions": {
    "structuralRule": {
      "type": "object",
      "properties": {
        "checkTarget": {"type": "string", "description": "Path or identifier of the system structure to check."},
        "validationCondition": {"type": "string", "description": "e.g., 'must conform to system_config_schema.json'"},
        "remediationAction": {"type": "string", "enum": ["REJECT", "AUTOCORRECT", "ISOLATE"], "default": "REJECT"}
      },
      "required": ["checkTarget", "validationCondition"]
    },
    "behavioralRule": {
      "type": "object",
      "properties": {
        "metricKey": {"type": "string", "description": "Key for the operational metric to monitor."},
        "threshold": {"type": "number"},
        "operator": {"type": "string", "enum": [">", "<", ">=", "<=", "==", "!="]},
        "timeWindowSeconds": {"type": "integer"}
      },
      "required": ["metricKey", "threshold", "operator"]
    },
    "resourceRule": {
      "type": "object",
      "properties": {
        "resourceType": {"type": "string", "enum": ["CPU_CORES", "MEMORY_GB", "IOPS_LIMIT"]},
        "hardLimit": {"type": "number"},
        "softLimitTrigger": {"type": "number"}
      },
      "required": ["resourceType", "hardLimit"]
    }
  },
  "required": ["schemaVersion", "rules"]
}