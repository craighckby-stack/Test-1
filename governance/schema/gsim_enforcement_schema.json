{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://sovereign-agi.com/governance/gsim_enforcement_schema_v2.1.json",
  "title": "GSIM Enforcement Map Schema V2.1",
  "type": "object",
  "properties": {
    "map_id": { "type": "string", "pattern": "^GSIM_ENFORCEMENT_V[0-9.]+" },
    "version": { "type": "string", "pattern": "^[0-9.]+" },
    "metadata": { "type": "object" },
    "enforcement_map": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["p_set_id", "p_set_type", "trigger_context", "trigger_axioms", "severity", "utility_enforcers", "active_gates", "dependencies"],
        "properties": {
          "p_set_id": { "type": "string" },
          "p_set_type": { "type": "string", "enum": ["Mitigation", "Integrity_Check", "Resource_Audit", "Regulatory"] },
          "trigger_context": { "type": "string", "enum": ["Runtime_Pre_Commit", "Pre_Halt_State", "Runtime_Verification", "Post_Execution"] },
          "trigger_axioms": { "type": "array", "items": { "type": "string", "pattern": "^GAX [I-V]{1,4}$" } },
          "severity": { "type": "string", "enum": ["CRITICAL", "HIGH", "MEDIUM", "LOW"] },
          "utility_enforcers": { "type": "array", "items": { "type": "string" } },
          "active_gates": { "type": "array", "items": { "type": "string" } },
          "dependencies": { "type": "array", "items": { "type": "string", "format": "uri" } }
        }
      }
    }
  },
  "required": ["map_id", "version", "enforcement_map"]
}