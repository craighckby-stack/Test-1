{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://api.sovereign-agi.com/schemas/Remediation_Plan_Schema_v2.json",
  "title": "Remediation Plan v2",
  "description": "Schema defining a plan for mitigating identified security risks or functional bugs.",
  "type": "object",
  "required": [
    "planId",
    "title",
    "targetSystem",
    "riskMetrics",
    "steps",
    "status"
  ],
  "properties": {
    "planId": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier for the remediation plan."
    },
    "title": {
      "type": "string",
      "description": "A brief title for the remediation effort."
    },
    "targetSystem": {
      "type": "string",
      "description": "The specific component, service, or repository targeted for remediation."
    },
    "vulnerabilityReference": {
      "type": "string",
      "description": "External reference ID (e.g., CVE, Jira ticket) linking to the original finding."
    },
    "riskMetrics": {
      "type": "array",
      "minItems": 1,
      "description": "Assessment of the risk magnitude.",
      "items": {
        "$ref": "#/$defs/RiskMetric"
      }
    },
    "steps": {
      "type": "array",
      "minItems": 1,
      "description": "The sequential actions required to achieve remediation.",
      "items": {
        "$ref": "#/$defs/RemediationStep"
      }
    },
    "status": {
      "type": "string",
      "description": "Current status of the plan execution.",
      "enum": ["pending", "in_progress", "awaiting_verification", "completed", "failed", "deferred"]
    },
    "createdDate": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp when the plan was generated."
    },
    "startDate": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "Timestamp when the remediation work officially started."
    },
    "completionDate": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "Timestamp when the remediation work was completed and verified."
    },
    "verificationMethod": {
      "type": "string",
      "description": "How remediation success will be validated (e.g., 'Integration Test ID: 404', 'Manual Audit by Security Team')."
    }
  },
  "$defs": {
    "RiskMetric": {
      "type": "object",
      "required": ["source", "severity", "score"],
      "properties": {
        "source": {
          "type": "string",
          "description": "Source of the risk rating (e.g., 'CVSS 3.1', 'Internal Triage')."
        },
        "severity": {
          "type": "string",
          "enum": ["Critical", "High", "Medium", "Low", "Informational"]
        },
        "score": {
          "type": "number",
          "description": "The numerical score associated with the risk (e.g., 9.8 for CVSS)."
        }
      },
      "additionalProperties": false
    },
    "RemediationStep": {
      "type": "object",
      "required": ["stepNumber", "description", "responsibleParty"],
      "properties": {
        "stepNumber": {
          "type": "integer",
          "minimum": 1
        },
        "description": {
          "type": "string",
          "description": "Detailed instruction for the step."
        },
        "responsibleParty": {
          "type": "string",
          "description": "Team or agent responsible for execution (e.g., 'Sovereign AGI/Code Modulator', 'Team X Engineering')."
        },
        "estimatedDurationHours": {
          "type": "number",
          "minimum": 0.1
        },
        "stepStatus": {
          "type": "string",
          "enum": ["pending", "in_progress", "completed", "skipped", "failed"],
          "default": "pending"
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}