{
  "General": {
    "ServiceName": "GACR.TelemetryAggregator",
    "Environment": "${ENV:PRODUCTION}",
    "ConfigVersion": 2.0,
    "ReloadPolicy": "HotReload",
    "ShardingKey": "source_id"
  },
  "Ingestion": {
    "Sources": [
      {
        "Name": "InternalMetrics",
        "Type": "HTTP",
        "Endpoint": "/api/v2/metrics",
        "RateLimitPerMinute": 100000,
        "SchemaValidationLevel": "Strict"
      },
      {
        "Name": "TracingEvents",
        "Type": "Kafka",
        "Topic": "gacr.telemetry.traces",
        "BufferSizeMB": 512
      }
    ],
    "MaxQueueDepthGB": 10
  },
  "Processing": {
    "Pipeline": [
      "SchemaEnforcement",
      "DynamicFilter",
      "PiiAnonymization",
      "MetricsAggregation"
    ],
    "AdaptiveSampling": {
      "Enabled": true,
      "PolicyType": "ResourceUtilization",
      "TargetCPUUtilization": 0.75,
      "MinSamplingRate": 0.001,
      "MaxSamplingRate": 1.0
    },
    "BatchingPolicy": {
      "MaxEvents": 5000,
      "MaxLatencyMS": 1000,
      "CompressionAlgorithm": "Zstd"
    }
  },
  "Export": {
    "Destinations": [
      {
        "Name": "DataLakeArchive",
        "Type": "S3",
        "Bucket": "gacr-telemetry-archive-v2",
        "Format": "Parquet",
        "DeliveryGuarantee": "AtLeastOnce"
      },
      {
        "Name": "RealtimeMonitoring",
        "Type": "PrometheusPushGateway",
        "URL": "http://monitor.gacr.internal:9091"
      }
    ]
  }
}