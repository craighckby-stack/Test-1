{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://gacr.agi/schemas/cmr_v2.2.json",
  "title": "Computational Model Registry Schema V2.2 (AGI-KERNEL Integrated)",
  "type": "object",
  "properties": {
    "manifest_id": {"type": "string", "pattern": "^CMR_V[0-9]+\\.[0-9]+$", "description": "Version identifier for the schema manifest.", "const": "CMR_V2.2"},
    "owner": {"type": "string"},
    "description": {"type": "string"},
    "integrity_hash": {"type": "string", "description": "Cryptographic hash of the registry content for integrity checking."},
    "verification_protocol": {"type": "string"},
    "models": {
      "type": "array",
      "description": "List of certified computation models.",
      "items": {
        "type": "object",
        "required": [
          "model_id", 
          "path", 
          "version", 
          "status", 
          "inputs_schema", 
          "audit_metadata", 
          "source_mdsm_link",
          "system_branch",
          "capability_assessment",
          "model_type"
        ],
        "properties": {
          "model_id": {"type": "string"},
          "model_type": {
             "type": "string",
             "description": "Categorization of the model based on its function.",
             "enum": ["CoreLogic", "Utility", "DataPersistence", "Orchestration", "Agentic", "Interface"]
          },
          "path": {"type": "string", "format": "uri-reference"},
          "version": {"type": "string", "pattern": "^[0-9]+\\.[0-9]+$"},
          "status": {"type": "string", "enum": ["Active", "Deprecated", "Staging", "Retired", "Experimental"]},
          
          "system_branch": {
             "type": "string",
             "description": "The AGI-KERNEL branch that currently owns or certifies this model's deployment.",
             "enum": ["main", "Nexus-Database", "System", "Testing"]
          },
          "kernel_maturity_required": {
             "type": "integer",
             "description": "Minimum kernel maturity percentage (0-100) required to safely execute this model.",
             "minimum": 0,
             "maximum": 100
          },
          "last_kernel_audit_cycle": {
             "type": "integer",
             "description": "The AGI-Kernel cycle number when this model was last audited or certified.",
             "minimum": 0
          },
          "capability_assessment": {
            "type": "object",
            "description": "The model's self-assessed performance across core AGI capabilities (0-10 scale).",
            "properties": {
              "error_handling": {"type": "number", "minimum": 0, "maximum": 10},
              "json_parsing": {"type": "number", "minimum": 0, "maximum": 10},
              "meta_reasoning": {"type": "number", "minimum": 0, "maximum": 10},
              "autonomy": {"type": "number", "minimum": 0, "maximum": 10},
              "creativity": {"type": "number", "minimum": 0, "maximum": 10}
            },
            "required": ["error_handling", "json_parsing", "meta_reasoning", "autonomy", "creativity"]
          },
          
          "inputs_schema": {
            "type": "object",
            "description": "Detailed schema definition for required inputs, including constraints.",
            "additionalProperties": {
              "type": "object",
              "required": ["type", "description"],
              "properties": {
                "type": {"type": "string", "enum": ["float", "integer", "string", "boolean", "object", "array"]},
                "unit": {"type": "string", "description": "Relevant unit of measurement (optional for complex types)."},
                "min": {"type": ["number", "null"], "description": "Minimum value constraint."},
                "max": {"type": ["number", "null"], "description": "Maximum value constraint."},
                "required_fields": {"type": "array", "items": {"type": "string"}, "description": "Required fields if type is 'object'."}
              }
            }
          },
          "audit_metadata": {
            "type": "object",
            "required": ["mgp_protocol", "approval_id", "certification_date", "failure_modes"],
            "properties": {
                "mgp_protocol": {"type": "string"},
                "approval_id": {"type": "string"},
                "approved_by": {"type": "string"},
                "certification_date": {"type": "string", "format": "date-time"},
                "failure_modes": {
                   "type": "array",
                   "description": "Mandatory list of known failure modes, error codes, and recovery strategies.",
                   "items": {
                      "type": "object",
                      "required": ["error_code", "description", "recovery_strategy"],
                      "properties": {
                         "error_code": {"type": "string", "description": "Standardized error code (e.g., KRNL_404, MDB_500)"},
                         "description": {"type": "string"},
                         "severity": {"type": "string", "enum": ["Critical", "Major", "Minor", "Warning"], "default": "Major"},
                         "recovery_strategy": {"type": "string", "description": "Specific action the kernel should take to recover."}
                      }
                   }
                }
            }
          },
          "source_mdsm_link": {"type": "string"}
        }
      }
    }
  },
  "required": ["manifest_id", "owner", "description", "integrity_hash", "models", "verification_protocol"]
}