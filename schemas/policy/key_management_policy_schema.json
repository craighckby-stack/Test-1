{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://agi.sovereign/schemas/v2/key_management_policy.json",
  "title": "Sovereign Key Management Policy Schema",
  "type": "object",
  "properties": {
    "key_policy_version": { "type": "string", "pattern": "^2\\.\\d+\\.\\d+$" },
    "key_type_definitions": {
      "type": "object",
      "description": "Defines cryptographic and storage requirements for different key types.",
      "patternProperties": {
        "^[A-Z_]+$": {
          "type": "object",
          "required": ["algorithm", "length_bits", "storage_tier"],
          "properties": {
            "algorithm": { "type": "string" },
            "length_bits": { "type": "integer", "minimum": 256 },
            "storage_tier": { "type": "string" }
          }
        }
      }
    },
    "entity_role_definitions": {
      "type": "object",
      "patternProperties": { ".+": { "type": "array", "items": { "type": "string" } } }
    },
    "rotation_schedule": {
      "type": "object",
      "patternProperties": {
        "^[A-Z_.]+": {
          "type": "object",
          "required": ["key_type", "lifetime_days"],
          "properties": {
            "key_type": { "type": "string", "description": "Must map to a defined key_type_definitions key." },
            "lifetime_days": { "type": "integer" },
            "rotation_window_days": { "type": "integer" }
          }
        }
      }
    }
  },
  "required": ["key_policy_version", "key_type_definitions", "entity_role_definitions", "rotation_schedule", "revocation_policy" ]
}