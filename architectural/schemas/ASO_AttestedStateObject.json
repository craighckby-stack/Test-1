{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://agi.sovereign/schemas/ASO_V1.json",
  "title": "Attested State Object (ASO) Schema",
  "description": "Defines the required structure for the SAL's primary output artifact, ensuring cryptographic verifiable inclusion and time-locking.",
  "type": "object",
  "required": [
    "payload_hash",
    "gatm_timestamp",
    "crot_signature",
    "ledger_anchor_hash"
  ],
  "properties": {
    "payload_hash": {
      "type": "string",
      "description": "SHA-512 hash of the original input payload P (pre-signing).",
      "format": "hex"
    },
    "gatm_timestamp": {
      "type": "integer",
      "description": "Epoch timestamp applied and verified by the GATM mechanism.",
      "minimum": 1
    },
    "crot_signature": {
      "type": "string",
      "description": "Digital signature (e.g., EdDSA) generated by the active CRoT key over (Payload Hash || GATM Timestamp).",
      "format": "base64"
    },
    "ledger_anchor_hash": {
      "type": "string",
      "description": "The root hash or index identifier confirming successful commitment to the independent cryptographic ledger (H_anchor).",
      "format": "hex"
    },
    "ledger_path_proof": {
      "type": "string",
      "description": "The verifiable proof structure (e.g., Merkle proof) necessary to reconstruct the commitment path back to the global ledger root. Mandatory for external verification.",
      "default": "N/A"
    }
  },
  "additionalProperties": false
}