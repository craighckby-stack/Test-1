Upgrading homomorphic encryption protocols to support secure multi-party computation and federated learning