{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "GAX ACVT Strictness Profiles (Risk-Tiered)",
  "description": "Defines abstract, risk-based validation threshold overrides for Autonomous Code Validation Threshold (ACVT) metrics. Profiles inherit missing metrics from BASE_PROFILE.",
  "$defs": {
    "ConstraintProfileSchema": {
      "type": "object",
      "description": "A partial or complete set of validation thresholds for ACVT metrics.",
      "properties": {
        "max_compute_delta_percent": {
          "type": "number",
          "minimum": 0,
          "description": "Max allowed relative (percentage) change in CPU/compute usage."
        },
        "max_memory_delta_mb": {
          "type": "number",
          "minimum": 0,
          "description": "Max allowed absolute increase in resident memory usage (MB)."
        },
        "max_io_latency_shift_ms": {
          "type": "number",
          "minimum": 0,
          "description": "Max allowed absolute shift (increase or decrease) in critical I/O path latency (ms)."
        },
        "max_maintainability_index_shift": {
          "type": "number",
          "minimum": 0,
          "description": "Max allowed absolute negative shift (drop) in the overall composite Maintainability Index (MI) score."
        },
        "security_severity_rejection_threshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 10,
          "description": "Minimum security severity score (CVSSv3 base score) that triggers automatic rejection."
        },
        "max_tco_factor_change": {
          "type": "number",
          "minimum": 0,
          "description": "Max allowed relative change (e.g., 0.05 for 5% increase) in Total Cost of Ownership factor."
        }
      },
      "additionalProperties": false
    },
    "RequiredBaseProfile": {
      "description": "The constraint set required to fully specify BASE_PROFILE.",
      "allOf": [
        {
          "$ref": "#/$defs/ConstraintProfileSchema"
        },
        {
          "required": [
            "max_compute_delta_percent",
            "max_memory_delta_mb",
            "max_io_latency_shift_ms",
            "max_maintainability_index_shift",
            "security_severity_rejection_threshold",
            "max_tco_factor_change"
          ]
        }
      ]
    }
  },
  "type": "object",
  "properties": {
    "BASE_PROFILE": {
      "description": "The mandatory, fully specified baseline constraints used for default validation.",
      "$ref": "#/$defs/RequiredBaseProfile",
      "examples": [
        {
          "max_compute_delta_percent": 0.2,
          "max_memory_delta_mb": 512,
          "max_io_latency_shift_ms": 1.0,
          "max_maintainability_index_shift": 0.5,
          "security_severity_rejection_threshold": 7.0,
          "max_tco_factor_change": 0.1
        }
      ]
    },
    "PROFILES": {
      "type": "object",
      "description": "Named strictness profiles for scenario-specific override application.",
      "properties": {
        "CRITICAL_PERFORMANCE": {
          "description": "Extremely tight constraints for core scheduling paths.",
          "allOf": [
            {
              "$ref": "#/$defs/ConstraintProfileSchema"
            }
          ],
          "examples": [
            {
              "max_compute_delta_percent": 0.05,
              "max_io_latency_shift_ms": 0.01
            }
          ]
        },
        "MAINTAINABILITY_FOCUS": {
          "description": "Strict emphasis on code quality and complexity reduction.",
          "allOf": [
            {
              "$ref": "#/$defs/ConstraintProfileSchema"
            }
          ],
          "examples": [
            {
              "max_maintainability_index_shift": 0.1,
              "max_tco_factor_change": 0.2
            }
          ]
        }
      },
      "additionalProperties": {
        "$ref": "#/$defs/ConstraintProfileSchema"
      }
    }
  },
  "required": [
    "BASE_PROFILE",
    "PROFILES"
  ]
}