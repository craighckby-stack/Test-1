{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://sovereign.agi/schema/security/isolateAsset.v2.json",
  "title": "Asset Isolation Command Parameters (v2)",
  "description": "Defines the required inputs for issuing an automated asset quarantine command, ensuring full auditability and defined scope.",
  "type": "object",
  "properties": {
    "target_asset_id": {
      "type": "string",
      "description": "The unique, immutable identifier (UUID/GaxID) of the asset to be quarantined.",
      "pattern": "^[A-Z0-9]{8,32}$",
      "minLength": 8,
      "maxLength": 32
    },
    "quarantine_level": {
      "type": "string",
      "description": "Severity and depth of isolation applied.",
      "enum": [
        "NETWORK_DENY_ALL",
        "OS_PROCESS_KILL",
        "LOGIC_FREEZE_SHUTDOWN",
        "FULL_SEGREGATION"
      ]
    },
    "reason_code": {
      "type": "string",
      "description": "Standardized Triage & Response Management (TRM) reason code (e.g., TRM-001-MALWARE).",
      "pattern": "^[A-Z]{3}-[0-9]{3}-[A-Z_]{3,20}$"
    },
    "initiator_id": {
      "type": "string",
      "description": "The unique identifier (user/system UUID) initiating the isolation action for auditing.",
      "format": "uuid"
    },
    "isolation_duration_hours": {
      "type": [
        "integer",
        "null"
      ],
      "description": "Optional: Duration in hours for temporary isolation. If null, isolation is permanent until manually revoked.",
      "minimum": 1
    },
    "context_details": {
      "type": "string",
      "description": "Detailed unstructured context justifying the action (e.g., incident ticket ID, source alert payload summary).",
      "minLength": 10
    }
  },
  "required": [
    "target_asset_id",
    "quarantine_level",
    "reason_code",
    "initiator_id"
  ],
  "additionalProperties": false
}