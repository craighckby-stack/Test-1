{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.agi.system/GRCS/v2",
  "title": "Governance, Risk, Compliance, and Security Configuration (v2)",
  "description": "Defines global policies, standards, risks, controls, and audit configuration for the autonomous system.",
  "type": "object",
  "properties": {
    "schemaVersion": {
      "$ref": "#/$defs/Version"
    },
    "policies": {
      "type": "array",
      "description": "High-level governance mandates defining required behavior and objectives.",
      "items": { "$ref": "#/$defs/Policy" }
    },
    "controls": {
      "type": "array",
      "description": "Master registry of system security and operational controls.",
      "items": { "$ref": "#/$defs/Control" }
    },
    "risks": {
      "type": "array",
      "description": "Identified organizational risks and mitigation strategies.",
      "items": { "$ref": "#/$defs/RiskAssessment" }
    },
    "complianceStandards": {
      "type": "array",
      "description": "Configuration mapping controls against required regulatory frameworks.",
      "items": { "$ref": "#/$defs/ComplianceStandard" }
    }
  },
  "required": ["schemaVersion", "policies", "controls", "risks"],
  "$defs": {
    "Version": {
        "type": "object",
        "description": "Metadata about the dataset version.",
        "properties": {
            "version": { "type": "string", "description": "Semantic version of the GRCS data set." },
            "updatedAt": { "type": "string", "format": "date-time", "description": "Timestamp of the last update." }
        },
        "required": ["version", "updatedAt"]
    },
    "ControlStatus": {
      "type": "string",
      "enum": ["Implemented", "In Review", "Awaiting Policy Refinement", "Mitigated", "Planned", "Exempted"]
    },
    "Policy": {
        "type": "object",
        "description": "A top-level governance mandate.",
        "properties": {
            "policyId": { "type": "string", "format": "ulid", "description": "Unique identifier for the policy." },
            "title": { "type": "string" },
            "mandate": { "type": "string", "description": "Detailed description of the required governance mandate." },
            "scope": { "type": "string", "enum": ["Global", "Development", "Runtime", "Data", "Security", "Financial"], "description": "The area or domain the policy covers." }
        },
        "required": ["policyId", "title", "mandate", "scope"]
    },
    "Control": {
      "type": "object",
      "description": "Defines a single security or operational control.",
      "properties": {
        "controlId": { "type": "string", "format": "ulid", "description": "Unique identifier for the control." },
        "policyRef": { "type": "string", "format": "ulid", "description": "Reference to the governing Policy ID.", "pattern": "^[0-7][0-9A-HJKMNP-TV-Z]{25}$" },
        "name": { "type": "string" },
        "description": { "type": "string" },
        "owner": { "type": "string" },
        "status": { "$ref": "#/$defs/ControlStatus" },
        "verificationPolicyId": { "type": "string", "format": "ulid", "description": "Reference to the necessary Audit Policy (GRCS_AuditPolicy).", "pattern": "^[0-7][0-9A-HJKMNP-TV-Z]{25}$"  },
        "mitigates": {
          "type": "array",
          "items": { "type": "string", "format": "ulid", "description": "References to RiskAssessment IDs mitigated by this control." }
        }
      },
      "required": ["controlId", "policyRef", "name", "status"]
    },
    "RiskAssessment": {
      "type": "object",
      "properties": {
        "riskId": { "type": "string", "format": "ulid" },
        "name": { "type": "string" },
        "vulnerabilityRef": { "type": "string", "description": "Reference to the underlying vulnerability, threat or asset affected." },
        "likelihood": { "type": "integer", "minimum": 1, "maximum": 5 },
        "impact": { "type": "integer", "minimum": 1, "maximum": 5 },
        "inherentRiskScore": { "type": "integer", "description": "Risk score prior to control application (Likelihood * Impact).", "readOnly": true },
        "residualRiskScore": { "type": "integer", "description": "Calculated score (after controls are applied).", "readOnly": true },
        "isCritical": { "type": "boolean", "default": false },
        "associatedControls": {
          "type": "array",
          "items": { "type": "string", "format": "ulid", "description": "References to Control IDs applied for mitigation." }
        }
      },
      "required": ["riskId", "name", "likelihood", "impact"]
    },
    "ComplianceStandard": {
      "type": "object",
      "description": "Configuration for regulatory standards mapping.",
      "properties": {
        "standardId": { "type": "string", "format": "ulid", "description": "Unique ID for this specific compliance standard configuration." },
        "standardName": { "type": "string", "description": "The official name of the standard (e.g., ISO 27001, PCI DSS)." },
        "jurisdiction": { "type": "string", "description": "Geographic or operational jurisdiction (e.g., EU, Internal, Financial)." },
        "sections": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "requirementRef": { "type": "string", "description": "Specific regulatory requirement ID (e.g., A.12.1.2)." },
              "controlMapping": {
                "type": "array",
                "items": { "type": "string", "format": "ulid", "description": "Mapped Control IDs addressing this requirement." }
              }
            },
            "required": ["requirementRef", "controlMapping"]
          }
        }
      },
      "required": ["standardId", "standardName", "jurisdiction"]
    }
  }
}