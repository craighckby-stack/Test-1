{
  "schemaName": "ConstraintFailureReportV2.0",
  "version": "2.0",
  "reportType": "CFRH",
  "description": "Standardized schema for reporting GSEP (General System Evolution Protocol) constraint failures.",
  "requiredFields": [
    "failureId",
    "gsepVersion",
    "intentId",
    "timestampUTC",
    "adjudicationStatus",
    "reasonVector",
    "criticalFailureDetails"
  ],
  "structure": {
    "failureId": {
      "type": "string",
      "format": "UUID",
      "description": "Globally unique identifier for this failure event instance."
    },
    "gsepVersion": {
      "type": "string",
      "format": "semver",
      "description": "The General System Evolution Protocol version active during the failure run."
    },
    "intentId": {
      "type": "string",
      "format": "M-01_ID",
      "description": "The M-01 Intent ID that initiated the failed protocol run."
    },
    "timestampUTC": {
      "type": "string",
      "format": "ISO8601",
      "description": "Timestamp of final adjudication failure (Zulu time)."
    },
    "adjudicationStatus": {
      "type": "string",
      "enum": [
        "FAILED"
      ],
      "description": "The mandatory terminal state flag for P-01 arbitration."
    },
    "reasonVector": {
      "type": "array",
      "description": "A vector of primary causes leading to P-01 rejection. Allows recording multiple simultaneous constraint breaches.",
      "minItems": 1,
      "items": {
        "type": "string",
        "enum": [
          "RISK_THRESHOLD_EXCEEDED",
          "POLICY_VETOED",
          "INTEGRITY_CHECK_FAIL",
          "RESOURCE_CONSTRAINT"
        ]
      }
    },
    "P01_Input_State": {
      "type": "object",
      "description": "Full locked state of P-01 input vectors (L4) captured at Stage 4 arbitration.",
      "required": [
        "efficacyScore",
        "riskFloorValue",
        "complianceVetoFlag"
      ],
      "properties": {
        "efficacyScore": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "S01 Efficacy Trust Score [0.0 - 1.0]."
        },
        "riskFloorValue": {
          "type": "number",
          "description": "S02 Calculated Risk Floor."
        },
        "complianceVetoFlag": {
          "type": "boolean",
          "description": "S03 Compliance Veto status (True if Vetoed)."
        }
      }
    },
    "criticalFailureDetails": {
      "type": "object",
      "description": "Debugging metadata identifying the precise source of failure within the execution environment.",
      "required": [
        "moduleSource",
        "tracebackHash"
      ],
      "properties": {
        "moduleSource": {
          "type": "string",
          "description": "The module or component reporting the failure."
        },
        "tracebackHash": {
          "type": "string",
          "format": "SHA256",
          "description": "A cryptographic hash of the condensed exception traceback."
        },
        "contextHash": {
          "type": "string",
          "format": "SHA256",
          "description": "Hash of relevant execution context (L5).
This aids in identifying non-determinism issues."
        }
      }
    }
  }
}