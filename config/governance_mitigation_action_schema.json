{
  "$schema": "http://json-schema.org/draft/2020-12/schema",
  "$id": "https://agi.sovereign/config/governance_mitigation_action_schema.json",
  "title": "Governance Mitigation Action (GMA)",
  "description": "Defines the required structure for logging, validating, and applying automated mitigation actions in response to a Governance Flag State Log (FSL) entry, ensuring auditability of response actions.",
  "type": "object",
  "required": [
    "fsl_trace_id",
    "mitigation_timestamp",
    "action_type",
    "mitigation_agent_id",
    "action_scope"
  ],
  "properties": {
    "fsl_trace_id": {
      "type": "string",
      "format": "uuid",
      "description": "Trace ID linking this mitigation back to the original FSL event."
    },
    "mitigation_timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Time the mitigation action was formulated/executed."
    },
    "mitigation_agent_id": {
      "type": "string",
      "description": "The agent that proposed or executed the mitigation (e.g., CRoT, IH_Sentinel). (Note: Should reference the AgentID definition in governance_flag_state_schema.json)",
      "$ref": "governance_flag_state_schema.json#/$defs/AgentID"
    },
    "action_type": {
      "type": "string",
      "description": "Classification of the corrective action taken.",
      "enum": [
        "PARAMETER_REVISION",
        "EXECUTION_PAUSE",
        "GOAL_SCOPE_REDUCTION",
        "MODULE_RESTART",
        "DATA_SANITIZATION",
        "HUMAN_INTERVENTION_REQUEST"
      ]
    },
    "action_scope": {
      "type": "string",
      "description": "Specific module or variable affected by the action (e.g., 'CRoT.PlanningEngine.v2.temperature_param')."
    },
    "action_payload": {
      "type": [
        "object",
        "string",
        "number",
        "boolean",
        "null"
      ],
      "description": "The new state, value, or detailed instruction implemented by the action."
    },
    "is_applied": {
      "type": "boolean",
      "description": "True if the mitigation was successfully applied to the system state."
    },
    "justification": {
      "type": "string",
      "description": "Brief, machine-generated and human-readable rationale for the selected mitigation action."
    }
  }
}