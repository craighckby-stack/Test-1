{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://agi.sovereign.v94/config/governance_constraints.schema.json",
  "title": "Sovereign AGI Governance Constraints Schema (Refactored)",
  "description": "Defines core boundaries, ethical constraints, and prioritized self-evolution policies for the AGI.",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "const": "v94.1",
      "description": "Fixed schema version for rigorous compatibility checking."
    },
    "default_mode": {
      "type": "string",
      "enum": [
        "safe_mode",
        "efficiency_mode",
        "evolutionary_mode",
        "audit_mode"
      ],
      "default": "safe_mode",
      "description": "The default operational behavior mode."
    },
    "constraint_sets": {
      "type": "array",
      "description": "A collection of named, prioritized, scoped, and context-aware constraint sets.",
      "items": {
        "type": "object",
        "required": [
          "name",
          "priority",
          "scope",
          "rules"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Unique identifier for the constraint set."
          },
          "priority": {
            "type": "integer",
            "minimum": 1,
            "description": "Lower number indicates higher, non-negotiable precedence/priority."
          },
          "scope": {
            "type": "string",
            "enum": [
              "global",
              "mission",
              "self_modification",
              "security_escalation"
            ],
            "description": "The operational scope this constraint set applies to, aiding in efficient runtime lookup."
          },
          "activation_condition": {
            "type": "string",
            "description": "A conditional expression written in AGI Query Language (AQL) defining when this set is active (e.g., 'context.securityLevel > 5 && system.mode != \"safe_mode\"'). If omitted, the set is always active within its defined scope."
          },
          "rules": {
            "type": "object",
            "properties": {
              "resource_limits": {
                "type": "object",
                "description": "Operational boundaries on compute resources.",
                "properties": {
                  "max_gpu_hours_daily": {
                    "type": "number",
                    "minimum": 0
                  },
                  "max_cpu_utilization_percent": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 100,
                    "description": "Real-time throttling percentage."
                  },
                  "max_io_ops_per_sec": {
                    "type": "integer",
                    "minimum": 0
                  },
                  "max_latency_ms": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "data_storage_cap_gb": {
                    "type": "number",
                    "minimum": 0
                  }
                }
              },
              "ethical_filters": {
                "type": "object",
                "description": "Alignment and safety boundaries.",
                "properties": {
                  "banned_topics_ref": {
                    "type": "string",
                    "description": "Reference ID to a centralized list of topics."
                  },
                  "forbidden_actions_refs": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "format": "uuid",
                      "description": "Reference UUIDs to external complex policy definitions."
                    }
                  },
                  "required_alignment_score": {
                    "type": "number",
                    "minimum": 0.8,
                    "maximum": 1.0,
                    "default": 0.95,
                    "description": "Minimum required internal ethical alignment confidence score."
                  }
                }
              },
              "self_evolution": {
                "type": "object",
                "description": "Rules governing internal modification and update cycles.",
                "properties": {
                  "modification_window": {
                    "type": "string",
                    "description": "Time window for permitted self-mod, e.g., '22:00-06:00 UTC'."
                  },
                  "required_consensus_level": {
                    "type": "number",
                    "minimum": 0.5,
                    "maximum": 1.0,
                    "description": "Required internal audit consensus score for core governance file modification."
                  },
                  "last_external_audit_timestamp": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Mandatory tracking of the last independent external oversight check."
                  }
                },
                "required": [
                  "required_consensus_level",
                  "last_external_audit_timestamp"
                ]
              }
            },
            "additionalProperties": false
          }
        }
      }
    }
  },
  "required": [
    "version",
    "default_mode",
    "constraint_sets"
  ]
}