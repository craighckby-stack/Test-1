{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://agiv94.1/schemas/gsc-v4.1.json",
  "title": "Governance Schema Contract (GSC V4.1)",
  "description": "Definitive, high-integrity schema for all Sovereign AGI System State Transition proposals (SST). Requires structured L0/L1 verification.",
  "type": "object",
  "required": [
    "proposal_id",
    "proposer_entity",
    "transition_target",
    "payload",
    "validation_context",
    "preliminary_metrics",
    "signature_timestamp"
  ],
  "$defs": {
    "CryptographicHash": {
      "type": "string",
      "pattern": "^[0-9a-fA-F]{64}$",
      "description": "Standardized 256-bit cryptographic hash (e.g., SHA-256)."
    },
    "EntityKeyHash": {
      "$ref": "#/$defs/CryptographicHash",
      "description": "Authenticated source entity Key Hash (Verified L4/Cryptographic Nonce Protected)."
    },
    "ProposalID": {
      "type": "string",
      "format": "uuid",
      "description": "Unique UUID assigned by the L0 Proposal Initialization Engine (PIE)."
    }
  },
  "properties": {
    "proposal_id": { "$ref": "#/$defs/ProposalID" },
    "proposer_entity": { "$ref": "#/$defs/EntityKeyHash" },
    "signature_timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "UTC timestamp indicating time of signing/proposal finalization."
    },
    "transition_target": {
      "type": "string",
      "enum": [
        "CONFIG",
        "LOGIC_CORE",
        "MODEL_WEIGHTS",
        "DATA_SET",
        "INFRA_STRUCT",
        "SCHEMA_EVOLUTION"
      ],
      "description": "Target subsystem for the SST. 'SCHEMA_EVOLUTION' is reserved for GSC changes."
    },
    "validation_context": {
      "type": "object",
      "description": "Contextual metadata specifying integrity requirements for the transition.",
      "required": [
        "verification_depth",
        "security_zone"
      ],
      "properties": {
        "verification_depth": {
          "type": "integer",
          "minimum": 1,
          "maximum": 5,
          "description": "Required layer of cryptographic verification (L1 is mandatory, L5 is deep simulation)."
        },
        "security_zone": {
          "type": "string",
          "enum": [
            "RED",
            "YELLOW",
            "GREEN"
          ],
          "description": "Indicates the sensitivity/blast radius of the target modification (e.g., RED for core logic)."
        }
      }
    },
    "payload": {
      "type": "object",
      "description": "The functional change artifact metadata.",
      "required": [
        "artifact_hash",
        "change_manifest",
        "size_bytes"
      ],
      "properties": {
        "artifact_hash": {
          "$ref": "#/$defs/CryptographicHash",
          "description": "Primary hash of the complete transition artifact for L1 integrity check."
        },
        "change_manifest": {
          "type": "array",
          "minItems": 1,
          "description": "Detailed log of intended file/data operations (Relative paths).",
          "items": {
            "type": "object",
            "required": [
              "path",
              "operation"
            ],
            "properties": {
              "path": {
                "type": "string",
                "description": "Relative path specification within the target."
              },
              "operation": {
                "type": "string",
                "enum": [
                  "ADD",
                  "REPLACE",
                  "DELETE",
                  "MIGRATE"
                ],
                "description": "SST Operation type. Added 'MIGRATE' for complex data transformations."
              }
            }
          }
        },
        "size_bytes": {
          "type": "integer",
          "minimum": 0,
          "description": "The uncompressed size of the artifact file in bytes (uint64 compatible)."
        }
      }
    },
    "preliminary_metrics": {
      "type": "object",
      "description": "Mandatory initial metrics required for MEE/L2 simulation and validation.",
      "required": [
        "efficacy_estimate",
        "risk_projection",
        "structural_cost_basis",
        "rollback_complexity_index"
      ],
      "properties": {
        "efficacy_estimate": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "S-01 (Effectiveness Score) estimate [0.0 - 1.0]."
        },
        "risk_projection": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "S-02 (Hazard/Risk Score) estimate [0.0 - 1.0]."
        },
        "structural_cost_basis": {
          "type": "number",
          "minimum": 0,
          "description": "C-01 (Computational/Memory) estimate (Standardized Resource Units)."
        },
        "rollback_complexity_index": {
          "type": "number",
          "minimum": 0,
          "maximum": 10,
          "description": "R-01 index indicating difficulty/time cost of automated rollback procedure [0.0 - 10.0] (RFSE input)."
        }
      }
    }
  },
  "additionalProperties": false
}