{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://sovereign-agi/governancePolicySchema.json",
  "title": "Sovereign AGI Governance Policy Definition Standard (GPDS v2.0)",
  "description": "Standardized, machine-executable JSON schema for all rules enforced by the Governance Rule System (GRS). Optimized for automated decision input (S-03 inputs) and structured VETO evaluation.",
  "type": "array",
  "items": {
    "type": "object",
    "required": [
      "policyId",
      "policyName",
      "ruleType",
      "version",
      "targetScope",
      "ruleDefinition"
    ],
    "properties": {
      "policyId": {
        "type": "string",
        "format": "uuid",
        "description": "Unique cryptographic ID (UUID v4) for policy traceability and indexing."
      },
      "version": {
        "type": "string",
        "pattern": "^\\d+\\.\\d+\\.\\d+$",
        "description": "Semantic versioning of the specific rule implementation (e.g., 1.0.0)."
      },
      "policyName": { "type": "string", "description": "Human-readable name for the rule." },
      "status": {
        "type": "string",
        "enum": ["ACTIVE", "DEPRECATED", "PENDING_REVIEW", "LOCKED"],
        "default": "ACTIVE",
        "description": "Current lifecycle status of the rule."
      },
      "ruleType": {
        "type": "string",
        "enum": ["SAFETY_VETO", "RESOURCE_CONSTRAINT", "DATA_INTEGRITY", "OPERATIONAL_LIVENESS", "AUDIT_REQUIREMENT"],
        "description": "Classification of the constraint type, specifying the necessary remediation/response workflow."
      },
      "severity": {
        "type": "integer",
        "minimum": 1,
        "maximum": 5,
        "default": 5,
        "description": "Severity level: 5 = Irreversible Hard VETO (S-01 failure), 1 = Logging/Warning."
      },
      "targetScope": {
        "type": "string",
        "pattern": "^(GLOBAL|MODULE|COMPONENT|WORKFLOW):[A-Z0-9_-]+$",
        "description": "Defines the enforcement boundary (e.g., GLOBAL, COMPONENT:C-11, WORKFLOW:CODE_EVOLUTION)."
      },
      "targetComponentId": {
        "type": "string",
        "pattern": "^[A-Z0-9-]{2,10}$",
        "description": "Specific component ID affected if scope requires granularity (e.g., C-11, AIA). Optional based on targetScope."
      },
      "ruleDefinition": {
        "type": "object",
        "description": "Structured definition of the executable logical condition, replacing free-form strings.",
        "required": ["triggerType", "conditionExpression"],
        "properties": {
          "triggerType": {
            "type": "string",
            "enum": ["PRE_EXECUTION", "POST_EXECUTION", "RUNTIME_METRIC", "STATE_MUTATION"],
            "description": "When the policy check should be evaluated relative to the target action/state change."
          },
          "conditionLanguage": {
            "type": "string",
            "enum": ["JESL", "CEL", "LUA_SANDBOX"],
            "default": "JESL",
            "description": "The language/engine used for evaluating the expression (JESL: JSON Expression Logic, Sovereign Standard).
          },
          "conditionExpression": {
            "type": "string",
            "description": "The serializable expression string (e.g., 'risk_vector.magnitude > 0.8 OR resource.allocation > resource.limit')."
          },
          "requiredMetrics": {
            "type": "array",
            "items": { "type": "string" },
            "description": "List of required metric names or state variables needed from the runtime context for evaluation."
          }
        }
      }
    }
  }
}