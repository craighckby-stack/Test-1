{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://sovereignagi.com/ih_log_v1.json",
  "title": "Integrity Halt Log Schema (TVCR Compliant)",
  "type": "object",
  "required": [
    "IH_Timestamp",
    "CRoT_ID",
    "GSEP_C_Stage",
    "Checklist_ID_Reference",
    "Halt_Reason",
    "State_Vector_Hash",
    "CSK_Verification_Signature"
  ],
  "properties": {
    "IH_Timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Time of detected Integrity Halt (UTC)."
    },
    "CRoT_ID": {
      "type": "string",
      "description": "Unique identifier for the CRoT instance initiating the halt."
    },
    "GSEP_C_Stage": {
      "type": "string",
      "enum": ["S0", "S10", "S_RUNTIME"],
      "description": "The GSEP-C stage during which the halt was triggered."
    },
    "Checklist_ID_Reference": {
      "type": "string",
      "description": "Reference ID from the CRoT Enforcement Manifest (e.g., 2.1).
    },
    "Halt_Reason": {
      "type": "string",
      "description": "Categorical description of the failure (e.g., LGC Mismatch, Tamper Detected)."
    },
    "State_Vector_Hash": {
      "type": "string",
      "description": "SHA-512 hash of the failed state vector prior to halting."
    },
    "CSK_Verification_Signature": {
      "type": "string",
      "description": "Cryptographic signature of the entire log entry generated by the PSM using the CSK."
    }
  }
}