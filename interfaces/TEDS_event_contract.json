{
  "title": "Trusted Event Data Stream (TEDS) Event Contract",
  "description": "Defines the mandatory schema for all auditable events logged by CRoT, GAX, and SGS agents. Enforces Tenet 3 (Auditability) and supports sequential integrity checking (Atomicity).",
  "type": "object",
  "required": [
    "timestamp",
    "sequence_id",
    "governance_agent",
    "event_type",
    "state_transition_phase",
    "event_hash"
  ],
  "properties": {
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "UTC ISO 8601 timestamp of the event."
    },
    "sequence_id": {
      "type": "integer",
      "description": "Monotonically increasing ID for auditing sequential integrity across all agents (S00-S14)."
    },
    "governance_agent": {
      "type": "string",
      "enum": [
        "CRoT",
        "GAX",
        "SGS",
        "SYSTEM_RRP"
      ],
      "description": "The agent responsible for generating the event."
    },
    "event_type": {
      "type": "string",
      "enum": [
        "AUDIT",
        "CONSTRAINT_CHECK",
        "STATE_WRITE",
        "HALT",
        "ROLLBACK",
        "COMMITMENT"
      ],
      "description": "Category of the logged event."
    },
    "state_transition_phase": {
      "type": "string",
      "pattern": "^S[0-9]{2}$",
      "description": "The GSEP-C stage (S00 to S14) relevant to the event."
    },
    "event_data": {
      "type": "object",
      "description": "Structured metadata relevant to the event (e.g., specific metrics, error codes, ACVD content)."
    },
    "event_hash": {
      "type": "string",
      "format": "hex",
      "description": "SHA-256 hash of the 'timestamp' + 'sequence_id' + 'event_data'. Used for chain-of-custody verification."
    },
    "related_artifact_id": {
      "type": "string",
      "description": "Reference ID for related artifacts (e.g., CSR hash, ASM ID, FSC signature)."
    }
  },
  "additionalProperties": false
}