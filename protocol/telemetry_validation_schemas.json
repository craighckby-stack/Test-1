{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://agi.sovereign.v94/protocol/telemetry_validation_schemas.json",
  "description": "Schema definition for highly strict, compliant telemetry across core AGI protocols (MPAM, SGS, ADTM). Centralized validation guarantees compliance before DIAL buffering and downstream routing. Uses common base elements and enforces payload specificity.",
  "$defs": {
    "TelemetryBase": {
      "type": "object",
      "properties": {
        "event_id": {
          "type": "string",
          "format": "uuid",
          "description": "Globally unique identifier for the telemetry event."
        },
        "asset_id": {
          "type": "string",
          "pattern": "^ASSET-[A-Z0-9]{8}$",
          "description": "Unique identifier of the hardware asset generating the data, enforced format."
        },
        "timestamp_utc": {
          "type": "string",
          "format": "date-time",
          "description": "The exact time the event was generated, in ISO 8601 UTC format."
        },
        "source_system": {
          "type": "string",
          "enum": ["DIAL_RTR", "AUX_SAT", "FIELD_NODE", "SIM_ENV", "CORE_MGMT"],
          "description": "The primary source system originating the data. Enum expanded for robustness."
        },
        "protocol_version": {
          "type": "string",
          "pattern": "^[0-9]+\\.[0-9]+$",
          "default": "1.1",
          "description": "Version of the protocol specification."
        }
      },
      "required": ["event_id", "asset_id", "timestamp_utc", "source_system"],
      "additionalProperties": false
    },
    "MPAM_Content": {
      "type": "object",
      "properties": {
        "pressure_reading": {
          "type": "number",
          "minimum": -100.0,
          "maximum": 5000.0,
          "description": "Micro-Pressure Anomaly Measurement (MPAM) reading in hPa, with defined safe operating range."
        },
        "calibration_drift": {
          "type": "number",
          "default": 0.0,
          "description": "Calibration offset deviation."
        }
      },
      "required": ["pressure_reading"],
      "additionalProperties": false
    },
    "SGS_Content": {
      "type": "object",
      "properties": {
        "transition_history": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 64
          },
          "minItems": 1,
          "description": "State Grid Synchronization (SGS) historical transition sequence identifiers."
        },
        "grid_status_code": {
          "type": "integer",
          "enum": [100, 200, 300, 404, 503],
          "description": "Current status code (e.g., 503 for Service Unavailable)."
        }
      },
      "required": ["transition_history", "grid_status_code"],
      "additionalProperties": false
    },
    "ADTM_Content": {
      "type": "object",
      "properties": {
        "differential_vector": {
          "type": "array",
          "items": {
            "type": "number"
          },
          "minItems": 3,
          "maxItems": 3,
          "description": "3D Autonomous Dynamic Trajectory Modeling (ADTM) differential vector [dx, dy, dz] in meters/second."
        },
        "confidence_score": {
          "type": "number",
          "minimum": 0.7,
          "maximum": 1.0,
          "description": "Model confidence threshold."
        }
      },
      "required": ["differential_vector", "confidence_score"],
      "additionalProperties": false
    }
  },
  "oneOf": [
    {
      "title": "MPAM Telemetry Event",
      "allOf": [
        {
          "$ref": "#/$defs/TelemetryBase"
        },
        {
          "type": "object",
          "properties": {
            "protocol_name": {
              "const": "MPAM",
              "description": "Required discriminator field."
            },
            "payload": {
              "$ref": "#/$defs/MPAM_Content"
            }
          },
          "required": ["protocol_name", "payload"]
        }
      ]
    },
    {
      "title": "SGS Telemetry Event",
      "allOf": [
        {
          "$ref": "#/$defs/TelemetryBase"
        },
        {
          "type": "object",
          "properties": {
            "protocol_name": {
              "const": "SGS",
              "description": "Required discriminator field."
            },
            "payload": {
              "$ref": "#/$defs/SGS_Content"
            }
          },
          "required": ["protocol_name", "payload"]
        }
      ]
    },
    {
      "title": "ADTM Telemetry Event",
      "allOf": [
        {
          "$ref": "#/$defs/TelemetryBase"
        },
        {
          "type": "object",
          "properties": {
            "protocol_name": {
              "const": "ADTM",
              "description": "Required discriminator field."
            },
            "payload": {
              "$ref": "#/$defs/ADTM_Content"
            }
          },
          "required": ["protocol_name", "payload"]
        }
      ]
    }
  ],
  "spec_version": "94.1.C",
  "comment": "Top-level validation now uses 'oneOf' structure enforced by the 'protocol_name' field for explicit schema discrimination during routing."
}