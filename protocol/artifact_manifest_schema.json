{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://dse-protocol/artifact_manifest_schema.json",
  "title": "DSE Protocol Transition Artifact Schema",
  "description": "Defines the required structure and cryptographic signature requirements for artifacts used in P-01 Finality verification (CSR, ECVM, TEMM).",
  "type": "object",
  "properties": {
    "artifact_id": {
      "type": "string",
      "enum": [
        "CSR",
        "ECVM",
        "TEMM"
      ],
      "description": "The type of Governance Artifact."
    },
    "gsep_stage_origin": {
      "type": "string",
      "description": "The specific GSEP-C stage (SXX) where the artifact was generated."
    },
    "actor_id": {
      "type": "string",
      "description": "The Governance Actor responsible for generation (CRoT, EMS, etc.)."
    },
    "payload_hash": {
      "type": "string",
      "format": "sha256",
      "description": "Cryptographic hash of the artifact's raw data payload."
    },
    "timestamp_utc": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp of artifact finalization."
    },
    "cryptographic_signature": {
      "type": "string",
      "description": "Digital signature from the generating actor, verifiable against the DSE governance keyring."
    },
    "verification_input_reference": {
      "type": "string",
      "description": "Reference ID linking this artifact to the specific ACVD verification constraint used."
    }
  },
  "required": [
    "artifact_id",
    "gsep_stage_origin",
    "actor_id",
    "payload_hash",
    "timestamp_utc",
    "cryptographic_signature"
  ]
}