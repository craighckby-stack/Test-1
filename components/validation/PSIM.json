{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "name": "PSIM_Validation_Core",
  "version": "2.1.0",
  "description": "Defines core validation policies, rules, and reusable definitions for Physical Security and Integrity Management (PSIM) entities across service endpoints.",
  "status": "ACTIVE",
  "definitions": {
    "entity_id_format": {
      "type": "string",
      "pattern": "^PSIM-[A-Z]{3}-[0-9]{6}$",
      "errorMessage": "ID must follow the standard PSIM format (e.g., PSIM-LOC-123456)."
    },
    "timestamp_format": {
      "type": "string",
      "format": "date-time"
    },
    "policy_status": {
      "type": "string",
      "enum": ["ENFORCED", "AUDIT_ONLY", "DEPRECATED"]
    }
  },
  "schemas": [
    {
      "name": "IntegrityCheckProfile",
      "endpoint": "/psim/v1/integrity_check",
      "policy_level": {
        "$ref": "#/definitions/policy_status"
      },
      "schema": {
        "type": "object",
        "properties": {
          "checkId": { "$ref": "#/definitions/entity_id_format" },
          "targetComponent": { "type": "string", "description": "The specific service or physical asset being verified." },
          "status": { "type": "string", "enum": ["PASSED", "FAILED", "WARNING"] },
          "scanDurationMs": { "type": "integer", "minimum": 0 },
          "lastChecked": { "$ref": "#/definitions/timestamp_format" }
        },
        "required": [
          "checkId",
          "targetComponent",
          "status"
        ],
        "additionalProperties": false
      }
    },
    {
      "name": "SensorEventStream",
      "endpoint": "/psim/v1/event_stream",
      "policy_level": {
        "$ref": "#/definitions/policy_status"
      },
      "schema": {
        "type": "object",
        "properties": {
          "eventId": { "type": "string", "format": "uuid" },
          "sensorId": { "type": "string" },
          "eventType": { "type": "string" },
          "timestamp": { "$ref": "#/definitions/timestamp_format" }
        },
        "required": [
          "eventId",
          "sensorId",
          "timestamp"
        ],
        "additionalProperties": false
      }
    }
  ]
}