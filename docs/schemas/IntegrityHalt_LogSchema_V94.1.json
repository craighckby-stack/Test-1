{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://agi.sovereign/schemas/IntegrityHalt_LogSchema_V94.1.json",
  "title": "Integrity Halt Logging Schema (IHLS)",
  "description": "Mandatory structure for committing Integrity Halt events to the Trust Verifiable Configuration Log (TVCL), signed by the CRoT Signing Key (CSK).",
  "type": "object",
  "required": [
    "HaltID",
    "CRoT_Timestamp",
    "AttestationSignature",
    "TriggerMechanism",
    "SeverityLevel",
    "ViolationContext",
    "PreViolationStateCommitment"
  ],
  "properties": {
    "HaltID": {
      "type": "string",
      "description": "Unique cryptographic nonce or UUID identifying this specific Integrity Halt event."
    },
    "CRoT_Timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp of the event, verified against the PSM's secure, attested clock."
    },
    "AttestationSignature": {
      "type": "string",
      "description": "Base64 encoded cryptographic signature of the entire log entry, generated by the PSM using the CRoT Signing Key (CSK). PQC compliant."
    },
    "TriggerMechanism": {
      "type": "string",
      "enum": ["CIM_PolicyViolation", "HETM_Activation", "UnsignedCode_Detection", "Entropy_Exhaustion", "Manual_Override"],
      "description": "The specific component or policy enforcement mechanism that initiated the IH sequence."
    },
    "SeverityLevel": {
      "type": "string",
      "enum": ["CRITICAL", "HIGH", "MEDIUM"],
      "description": "The assessed severity of the integrity breach."
    },
    "ViolationContext": {
      "type": "object",
      "description": "Detailed contextual data, including hashes of affected components and policy rules violated.",
      "required": ["AffectedComponentHash", "ViolationPolicyID"],
      "properties": {
        "AffectedComponentHash": {
          "type": "string"
        },
        "ViolationPolicyID": {
          "type": "string"
        }
      }
    },
    "PreViolationStateCommitment": {
      "type": "string",
      "description": "A cryptographic hash representing the verified system state immediately preceding the activation of the Integrity Halt (S0 transition commitment)."
    }
  }
}