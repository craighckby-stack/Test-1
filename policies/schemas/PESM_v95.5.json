{
  "$schema": "http://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.sovereign.agi/manifest/PESM_V96.0.json",
  "title": "Protocol Evolution Structure Manifest Base Schema",
  "description": "Mandatory base schema definition for all Governance Asset & Registry (GACR) Manifests, enhancing traceability and security context.",
  "type": "object",
  "properties": {
    "SchemaID": {
      "const": "PESM_V96.0",
      "description": "Internal version identifier for the definition of this schema."
    },
    "ManifestID": {
      "type": "string",
      "pattern": "^[A-Z]{3,5}$",
      "description": "Unique 3-5 letter acronym corresponding to the specific manifest type (e.g., PVLM, CFTM)."
    },
    "Version": {
      "type": "string",
      "format": "regex",
      "pattern": "^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$",
      "description": "Strict SemVer 2.0 compliant version of the specific manifest file content."
    },
    "SecurityContext": {
      "type": "object",
      "description": "Cryptographic and Chain of Trust (CRoT) verification details.",
      "properties": {
        "PayloadDigest": {
          "type": "string",
          "format": "hex",
          "description": "The cryptographic hash (e.g., SHA-384) of the raw serialized Payload block."
        },
        "DigestAlgorithm": {
          "type": "string",
          "enum": [
            "SHA-384",
            "SHA-512"
          ],
          "default": "SHA-384",
          "description": "The modern algorithm used to calculate PayloadDigest."
        },
        "Signature": {
          "type": "string",
          "description": "Digital signature covering the ManifestID, Version, SecurityContext fields, and PayloadDigest."
        },
        "SigningTimestampUTC": {
          "type": "string",
          "format": "date-time",
          "description": "Time of CRoT signing."
        }
      },
      "required": [
        "PayloadDigest",
        "DigestAlgorithm",
        "Signature",
        "SigningTimestampUTC"
      ]
    },
    "Payload": {
      "type": "object",
      "description": "The domain-specific configuration content.",
      "minProperties": 1
    }
  },
  "required": [
    "SchemaID",
    "ManifestID",
    "Version",
    "SecurityContext",
    "Payload"
  ],
  "additionalProperties": false
}